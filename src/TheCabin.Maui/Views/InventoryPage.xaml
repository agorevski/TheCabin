<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:TheCabin.Maui.ViewModels"
             xmlns:models="clr-namespace:TheCabin.Core.Models;assembly=TheCabin.Core"
             x:Class="TheCabin.Maui.Views.InventoryPage"
             x:DataType="viewmodels:InventoryViewModel"
             BackgroundColor="#1a1a1a"
             Title="Inventory">

    <Grid RowDefinitions="Auto,*,Auto" Padding="16">
        
        <!-- Header -->
        <Border Grid.Row="0" 
                BackgroundColor="#2d2d2d"
                Stroke="#444"
                StrokeThickness="1"
                Padding="16"
                Margin="0,0,0,16">
            <Border.StrokeShape>
                <RoundRectangle CornerRadius="8"/>
            </Border.StrokeShape>
            
            <Grid ColumnDefinitions="*,Auto">
                <Label Grid.Column="0"
                       Text="Your Inventory"
                       FontSize="24"
                       FontAttributes="Bold"
                       TextColor="White"
                       VerticalOptions="Center"/>
                <Label Grid.Column="1"
                       Text="{Binding WeightDisplay}"
                       FontSize="14"
                       TextColor="#aaa"
                       VerticalOptions="End"/>
            </Grid>
        </Border>
        
        <!-- Item List -->
        <CollectionView Grid.Row="1"
                       ItemsSource="{Binding Items}"
                       SelectionMode="None">
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="models:GameObject">
                    <SwipeView>
                        <SwipeView.RightItems>
                            <SwipeItems>
                                <SwipeItem Text="Drop"
                                          BackgroundColor="#D0021B"
                                          Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:InventoryViewModel}}, Path=DropItemCommand}"
                                          CommandParameter="{Binding .}"/>
                                <SwipeItem Text="Use"
                                          BackgroundColor="#4A90E2"
                                          Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:InventoryViewModel}}, Path=UseItemCommand}"
                                          CommandParameter="{Binding .}"/>
                            </SwipeItems>
                        </SwipeView.RightItems>
                        
                        <Border BackgroundColor="#2d2d2d"
                                Stroke="#444"
                                StrokeThickness="1"
                                Padding="16"
                                Margin="0,4">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="8"/>
                            </Border.StrokeShape>
                            
                            <Border.GestureRecognizers>
                                <TapGestureRecognizer 
                                    Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:InventoryViewModel}}, Path=ExamineItemCommand}"
                                    CommandParameter="{Binding .}"/>
                            </Border.GestureRecognizers>
                            
                            <Grid ColumnDefinitions="60,*,Auto">
                                <Label Grid.Column="0"
                                       Text="ðŸ“¦"
                                       FontSize="32"
                                       HorizontalOptions="Center"
                                       VerticalOptions="Center"/>
                                
                                <VerticalStackLayout Grid.Column="1" 
                                                    Padding="12,0,0,0"
                                                    VerticalOptions="Center">
                                    <Label Text="{Binding Name}"
                                           FontSize="16"
                                           FontAttributes="Bold"
                                           TextColor="White"/>
                                    <Label Text="{Binding Description}"
                                           FontSize="12"
                                           TextColor="#aaa"
                                           LineBreakMode="TailTruncation"
                                           MaxLines="2"/>
                                </VerticalStackLayout>
                                
                                <Label Grid.Column="2"
                                       Text="{Binding Weight, StringFormat='{0} kg'}"
                                       FontSize="12"
                                       TextColor="#aaa"
                                       VerticalOptions="Center"
                                       Margin="8,0,0,0"/>
                            </Grid>
                        </Border>
                    </SwipeView>
                </DataTemplate>
            </CollectionView.ItemTemplate>
            
            <CollectionView.EmptyView>
                <VerticalStackLayout Padding="32"
                                    HorizontalOptions="Center"
                                    VerticalOptions="Center">
                    <Label Text="ðŸŽ’"
                           FontSize="64"
                           HorizontalOptions="Center"/>
                    <Label Text="Your inventory is empty"
                           FontSize="16"
                           TextColor="#aaa"
                           HorizontalOptions="Center"
                           Margin="0,16,0,8"/>
                    <Label Text="Pick up items as you explore"
                           FontSize="12"
                           TextColor="#666"
                           HorizontalOptions="Center"/>
                </VerticalStackLayout>
            </CollectionView.EmptyView>
        </CollectionView>
        
        <!-- Action Hint -->
        <Border Grid.Row="2"
                BackgroundColor="#2d2d2d"
                Stroke="#444"
                StrokeThickness="1"
                Padding="12"
                Margin="0,16,0,0">
            <Border.StrokeShape>
                <RoundRectangle CornerRadius="6"/>
            </Border.StrokeShape>
            
            <Label Text="ðŸ’¡ Tap to examine â€¢ Swipe left to use or drop"
                   FontSize="12"
                   TextColor="#aaa"
                   HorizontalOptions="Center"/>
        </Border>
        
    </Grid>
</ContentPage>
